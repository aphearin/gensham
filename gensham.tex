\documentclass[usenatbib,usegraphicx,letterpaper]{mn2e}
\usepackage[totalwidth=480pt,totalheight=680pt]{geometry}

\usepackage{amssymb}
\usepackage{epsfig}
\usepackage{amsmath}
\usepackage{color}

%-------- journals
\newcommand{\araa}{ARAA~}
\newcommand{\apj}{ApJ~}
\newcommand{\apjl}{ApJL~}
\newcommand{\apjs}{ApJS~}
\newcommand{\mnras}{MNRAS~}
\newcommand{\nat}{Nature~}
\newcommand{\physrep}{Phys. Rep.~}
\newcommand{\aj}{AJ~}
\newcommand{\pasp}{PASP~}
\newcommand{\prd}{Phys.~Rev.~D}
\newcommand{\jcap}{JCAP}


\bibliographystyle{mn2e} 
\newcounter{address}



%%%%% Halo Model %%%%%
\newcommand{\Ngal}{N_{\rm gal}}
\newcommand{\Nhalo}{N_{\rm halo}}

\newcommand{\dnhalodx}[1]{{\rm d}n_{\rm h} / {\rm d}#1}
\newcommand{\bhalo}{b_{\rm h}}

\newcommand{\philm}[2]{\Phi(#1|#2)}
\newcommand{\meann}[1]{\langle#1\rangle}

\newcommand{\vmax}{V_{\rm max}}
\newcommand{\mvir}{M_{\rm vir}}

\newcommand{\mpeak}{M_{\rm peak}}
\newcommand{\vpeak}{V_{\rm peak}}


%%%% Misc %%%
\newcommand{\beq}{\begin{equation}}
\newcommand{\eeq}{\end{equation}}
\newcommand{\beqray}{\begin{eqnarray}}
\newcommand{\eeqray}{\end{eqnarray}}

\newcommand{\ben}{\begin{enumerate}}
\newcommand{\een}{\end{enumerate}}
\newcommand{\bit}{\begin{itemize}}
\newcommand{\eit}{\end{itemize}}

\newcommand{\dd}{\mathrm{d}}


\newcommand{\mstar}{M_{\ast}}


\usepackage{epsfig}  \usepackage{graphicx}   \usepackage{rotating}

\begin{document}

\title[Generalized Galaxy-Halo Modeling]
{Discovering the True Regulator of Stellar Mass}

\author[A.P. Hearin]{Andrew P. Hearin}

\maketitle




\begin{abstract}
Empirical models of the galaxy-halo connection are built upon the assumption that some host halo property serves as the statistical regulator of the stellar mass $\mstar$ content of the halo. This is the core assumption that permits us to use N-body simulations in cosmological parameter inference. In this paper I introduce the weighted cumulative abundance technique (WCA), which allows {\em the choice of halo property itself} to be parameterized and continuously varied in a likelihood analysis. There are significant, systematic differences between empirical models based on different halo properties, and it has recently been shown that the associated systematic error known as {\em galaxy assembly bias} threatens the precision cosmology program.  I describe how to use WCA to  generalize abundance matching models as well as halo occupation distribution (HOD) models to make them more robust to assembly bias. I conclude by discussing the role that the WCA technique will play in future constraints on cosmology with large-scale structure. 
\end{abstract}


\section{Introduction}

\ben
\item The halo model is the premier tool to constrain dark energy with large-scale structure measurements. 
\item How does that work? First you enumerate $\dnhalodx{\mvir}$ and $\bhalo(\mvir)$ through a painful calibration exercise. 

Next you write down a parameterized form of an occupation model such as $\philm{\mstar}{\mvir}$ or $\meann{\Ngal}(\mvir).$

Finally, you use e.g., clustering and lensing predictions of the model to constrain both cosmological and galaxy-halo parameters. 
\item However, if you base your model on different halo properties, your model predictions may be qualitatively distinct, because assembly bias is scale dependent. Halo mass $\mvir$ is the most widespread, but its definition is based on spherical top-hat collapse, which is poorly motivated in detail. The impact of the choice of halo parameter has been poorly studied heretofore, because there has been no way to easily compare models based on different properties, and because precision demands have only recently reached this point. 
\item This paper provides a new technique that allows us to construct and compare models that are identical in every way, but differ by the choice of halo property. 

The technique also allows us to parameterize our choice of the halo property in a continuous fashion, so that we can marginalize over our uncertainty in the true halo property. 
\item The AM formulation of the generalization is in \S~\ref{sec:sham}, and the HOD/CLF formulation is in  \S~\ref{sec:hodclf}. 

\een

%The first step in all traditional formulations of empirical models is to choose a particular halo property upon which the model is based. In AM-type models, this property is commonly something like $\vpeak$ or $\mpeak$ of both hosts and subs, while in HOD/CLF-type models this property is usually host halo $\mvir.$ 


\section{Abundance Matching with a Generalized Halo Property}
\label{sec:sham}

Suppose we want to build a model based on a some property $x,$ which we want to be in some sense intermediate between two halo properties we already know and love. For simplicity and definiteness, let's figure out how to do this using $\vpeak$ and $\mpeak$ in the absence of scatter. 

In the standard approach, we first compute the cumulative number density of the halos, and calculate our mapping $\bar{\mstar}(x)$ in the normal way, by finding the zero of the function 
\beq
\label{eq:shamdef}
\mathcal{F}(\mstar | x) \equiv \Nhalo(> x) - \Ngal(>\mstar),
\eeq
where $\Nhalo(>x)$ is the cumulative abundance of (sub)halos as a function of $x,$ and $\Ngal(>\mstar)$ is the observed cumulative stellar mass function, 
\beqray
\Nhalo(>x) & \equiv & \int_{x}^{\infty}\dd{x'}\dnhalodx{x'}, \\
\Ngal(>\mstar) & \equiv & \int_{\mstar}^{\infty}\dd\mstar'\Phi_{\rm gal}(\mstar'). 
\eeqray
Ok, so the core quantity that we need to do abundance matching with, say, $\vpeak,$ is just the value of $\Nhalo(>\vpeak)$ for every (sub)halo in our box. Computing this quantity is trivial, $$\Nhalo(>\vpeak^{\rm i})={\rm i}/L^{3}_{\rm box},$$ where $i$ is the $\vpeak-$based rank-order of the (sub)halos. 

That's all the standard jam. But now suppose we want to conduct AM using a property $x$ that is ``between" $\vpeak$ and $\mpeak.$ We begin in the normal way by computing the numerical value of $\Nhalo(>\mpeak)$ and $\Nhalo(>\vpeak)$ for every (sub)halo in the box, exactly as above. Next we define the following {\em weighted cumulative abundance}:
\beq
\Nhalo(>x) \equiv w\Nhalo(>\vpeak) + (1-w)\Nhalo(>\mpeak), 
\eeq
where $w$ is any number between $0$ and $1.$ This gives us a numerical value of $\Nhalo(>x)$ for every (sub)halo in the box. 
Now we just use Eq.~\ref{eq:shamdef} to assign $\mstar$ to every (sub)halo using AM based on our newly defined property $x.$ 

Notice that we never even assigned values of $x$ to the (sub)halos! So this trick entirely circumvents the problem that $\mpeak$ and $\vpeak$ do not even have the same units. {\bf Upshot:} we can allow $w$ to be a continuously varying parameter in an MCMC, allowing us to  marginalize over our uncertainty about the ``true" halo property in the AM-prediction of $\mstar.$ This provides a natural extension to the abundance matching parameter scan explored in \citet{reddick_etal12}. 


\section{The HOD/CLF with a Generalized Halo Property}
\label{sec:hodclf}

Now let's build new families of HOD models $P(\Ngal|x)$ based on a generalized host halo property $x$ that's ``between" $\mvir$ and $\vmax.$ 

\ben
\item Write down your favorite parameterization for $P(\Ngal | \mvir).$
\item Compute $\Nhalo(>\mvir)$ for every halo.\footnote{Again, this is computed as $i/L_{\rm box}^{3},$ except this time neglecting subhalos from all aspects of the calculation, as is usual for this type of model.} 

The outcome of this step is to provide a bijective mapping between $\Nhalo(>\mvir)\leftrightarrow\mvir.$ 
\item Use the mapping provided by Step (2) to recast $$P(\Ngal | \mvir)\Rightarrow P(\Ngal |\Nhalo(>\mvir)).$$
This is accomplished by function composition: $$\langle\Ngal\rangle(\mvir)\Rightarrow\langle\Ngal\rangle(\Nhalo(>\mvir)).$$

This doesn't change our original model in the slightest; we're now just using a new label $\Nhalo(>\mvir)$ in our equations.
\item Compute $\Nhalo(>\vmax)$ for every halo, giving us $\Nhalo(>\vmax)\leftrightarrow\vmax.$ 
\item By replacing all appearances of $\Nhalo(>\mvir)$ with $\Nhalo(>\vmax),$ 
we construct a new HOD model $P(\Ngal|\vmax)$ that is the ``$\vmax-$equivalent'' of our original model $P(\Ngal | \mvir).$
\item More than this, we can also construct entirely new models using $$\Nhalo(>x) \equiv w\Nhalo(>\vmax) + (1-w)\Nhalo(>\mvir).$$ 
Those models will be the ``$x-$equivalent'' HOD model to our original. Again, at no point do we ever need to compute the value of $x.$
\een

This gives us a recipe to explore entirely new models that are in every way equivalent to our original $P(\Ngal | \mvir),$ but instead belong to a continuous family of halo properties spanned by $\vmax$ and $\mvir.$

\section{Conclusion}

Going beyond vir is not just  amatter of taste The danger is to rule out GR. This i s a serious dngerCurrently, no guarantees YOu just hope you've chosen the right proprty, based on ery loittle at all. Mostly heurisic argumnts that are known o fail in detail. 


\bibliography{gensham}

\end{document}

